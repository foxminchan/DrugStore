@page "/categories/edit/{Id}"
@using DrugStore.BackOffice.Components.Pages.Categories.Requests

<PageTitle>Edit Category</PageTitle>

<RadzenBreadCrumb>
    <RadzenBreadCrumbItem Path="/" Text="Home"/>
    <RadzenBreadCrumbItem Path="/categories" Text="Categories"/>
    <RadzenBreadCrumbItem Text="Edit"/>
</RadzenBreadCrumb>

<RadzenText TextStyle="TextStyle.H3">Categories</RadzenText>

@if (_busy)
{
    <RadzenPanel>
        <RadzenProgressBar Style="height: 4px"/>
    </RadzenPanel>
}
else
{
    <RadzenAlert Shade="Shade.Lighter" Variant="Variant.Flat" AlertStyle="AlertStyle.Danger" Visible="_error">
        <RadzenColumn SizeMD="9">
            <RadzenLabel Style="font-weight: bold" Text="Cannot save Category. Please reload."/>
        </RadzenColumn>
        <RadzenColumn SizeMD="3">
            <RadzenButton ButtonStyle="ButtonStyle.Secondary" Icon="autorenew" Style="margin-bottom: 20px" Text="Reload"
                          Click="OnInitializedAsync"/>
        </RadzenColumn>
    </RadzenAlert>
    <RadzenColumn SizeMD="12">
        <RadzenTemplateForm TItem="UpdateCategory" Data="_category" Submit="OnSubmit">
            <RadzenFieldset Text="Category information">
                <RadzenStack Gap="1rem">
                    <RadzenTextBox @bind-Value="_category.Id" Name="Id" Style="display: none"/>
                    <RadzenLabel Text="Name" Component="Name"/>
                    <RadzenTextBox Style="display: block"
                                   Name="Name"
                                   ReadOnly="_busy"
                                   @bind-Value="_category.Name"
                                   class="w-100"
                                   Placeholder="Enter category name"/>
                    <RadzenCustomValidator Component="Name"
                                           Text="Name is required and has 50 characters maximum"
                                           Validator="() => ValidateCategoryName(_category.Name)"/>
                    <RadzenLabel Text="Description" Component="Description"/>
                    <RadzenTextArea Style="display: block"
                                    Name="Description"
                                    ReadOnly="_busy"
                                    @bind-Value="_category.Description"
                                    class="w-100"
                                    Placeholder="Enter category description"/>
                    <RadzenCustomValidator Component="Description"
                                           Text="Description has 500 characters maximum"
                                           Validator="() => ValidateCategoryDescription(_category.Description)"/>
                </RadzenStack>
            </RadzenFieldset>
            <RadzenStack Style="margin-top:1rem;"
                         Orientation="Orientation.Horizontal"
                         AlignItems="AlignItems.Center"
                         JustifyContent="JustifyContent.Center"
                         Gap="0.5rem">
                <RadzenButton ButtonStyle="ButtonStyle.Primary"
                              ButtonType="ButtonType.Submit"
                              Icon="save"
                              Text="Save"
                              Variant="Variant.Flat"
                              IsBusy="_busy"/>
                <RadzenButton ButtonStyle="ButtonStyle.Light"
                              Icon="cancel"
                              Text="Cancel"
                              Variant="Variant.Flat"
                              IsBusy="_busy"
                              Click="CancelButtonClick"/>
            </RadzenStack>
        </RadzenTemplateForm>
    </RadzenColumn>
}